# This benchamrking suite contains 11 io tests and 9 rpc tests.
# The purpose of this suite is to provide a quick way to test the performance after each change

### TESTS

### IO

# The following 8 tests test io_tester for sequential and random reads and writes of size 4kB and 256kB - each combination

- type: io
  iterations: 1
  name: io_seqread_4kb
  config:
  - name: io_seqread_4kb
    type: seqread
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 4kB
      shares: 10

- type: io
  iterations: 1
  name: io_seqread_256kb
  config:
  - name: io_seqread_256kb
    type: seqread
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 256kB
      shares: 10

- type: io
  iterations: 1
  name: io_seqwrite_4kb
  config:
  - name: io_seqwrite_4kb
    type: overwrite
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 4kB
      shares: 10

- type: io
  iterations: 1
  name: io_seqwrite_256kb
  config:
  - name: io_seqwrite_256kb
    type: overwrite
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 256kB
      shares: 10

- type: io
  iterations: 1
  name: io_randread_4kb
  config:
  - name: io_randread_4kb
    type: randread
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 4kB
      shares: 10

- type: io
  iterations: 1
  name: io_randread_256kb
  config:
  - name: io_randread_256kb
    type: randread
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 256kB
      shares: 10

- type: io
  iterations: 1
  name: io_randwrite_4kb
  config:
  - name: io_randwrite_4kb
    type: randwrite
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 4kB
      shares: 10

- type: io
  iterations: 1
  name: io_randwrite_256kb
  config:
  - name: io_randwrite_256kb
    type: randwrite
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 256kB
      shares: 10

# The following test checks the impact of adding think_time to random reads

- type: io
  iterations: 1
  name: io_randread_256kb_thinking
  config:
  - name: io_randread_256kb_thinking
    type: randread
    shards: all
    shard_info:
      parallelism: 10
      reqsize: 256kB
      shares: 10
      think_time: 100us

# The following 2 tests check the impact of setting parallelism to either 1 or 20 for random reads, instead of the default 10

- type: io
  iterations: 1
  name: io_randread_256kb_parallel_1
  config:
  - name: io_randread_256kb_parallel_1
    type: randread
    shards: all
    shard_info:
      parallelism: 1
      reqsize: 256kB
      shares: 10

- type: io
  iterations: 1
  name: io_randread_256kb_parallel_20
  config:
  - name: io_randread_256kb_parallel_20
    type: randread
    shards: all
    shard_info:
      parallelism: 20
      reqsize: 256kB
      shares: 10

### RPC

# The following 6 tests check rpc with 32kB and 256kB payloads, for each verbs from unidirectional, bidirectional and write 

- type: rpc
  name: rpc_unidirectional_32kb
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_unidirectional_32kb
        type: rpc_streaming
        verb: unidirectional
        parallelism: 10
        shares: 100
        payload: 32kB

- type: rpc
  name: rpc_unidirectional_256kb
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_unidirectional_256kb
        type: rpc_streaming
        verb: unidirectional
        parallelism: 10
        shares: 100
        payload: 256kB

- type: rpc
  name: rpc_bidirectional_32kb
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_bidirectional_32kb
        type: rpc_streaming
        verb: bidirectional
        parallelism: 10
        shares: 100
        payload: 32kB

- type: rpc
  name: rpc_bidirectional_256kb
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_bidirectional_256kb
        type: rpc_streaming
        verb: bidirectional
        parallelism: 10
        shares: 100
        payload: 256kB

- type: rpc
  name: rpc_write_32kb
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_write_32kb
        type: rpc
        verb: write
        parallelism: 10
        shares: 100
        payload: 32kB

- type: rpc
  name: rpc_write_256kb
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_write_256kb
        type: rpc
        verb: write
        parallelism: 10
        shares: 100
        payload: 256kB

# The following test checks the performance of echo

- type: rpc
  name: rpc_echo
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_echo
        type: rpc
        verb: echo
        parallelism: 10
        shares: 100
        payload: 32kB

# The following 2 tests check the impact of parallelism (set to 1 or 20) for bidirectional streaming

- type: rpc
  name: rpc_bidirectional_32kb_parallel_1
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_bidirectional_32kb_parallel_1
        type: rpc_streaming
        verb: bidirectional
        parallelism: 1
        shares: 100
        payload: 32kB

- type: rpc
  name: rpc_bidirectional_32kb_parallel_20
  config:
    client:
      nodelay: true
    server:
      nodelay: true
    jobs:
      - name: rpc_bidirectional_32kb_parallel_20
        type: rpc_streaming
        verb: bidirectional
        parallelism: 20
        shares: 100
        payload: 32kB
